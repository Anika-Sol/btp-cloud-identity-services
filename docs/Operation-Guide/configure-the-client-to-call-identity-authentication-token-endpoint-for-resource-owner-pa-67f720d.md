<!-- loio67f720de8a36466585a1e9074e6f457c -->

# Configure the Client to Call Identity Authentication Token Endpoint for Resource Owner Password Credentials Flow

The token endpoint is used to get the user's access token, id token and refresh token.



This document explains how to call the token endpoint and what are the parameters supported by Identity Authentication.



## **Request**

**URI:**`https://<tenant ID>.accounts.ondemand.com/oauth2/token`

**HTTP Method:***POST*



### Request Headers


<table>
<tr>
<th valign="top">

Header



</th>
<th valign="top">

Required



</th>
<th valign="top">

Values



</th>
</tr>
<tr>
<td valign="top">

`Content-Type`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

application/x-www-form-urlencoded



</td>
</tr>
<tr>
<td valign="top">

`Authentication`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

-   Basic Authentication -

    Client ID and a Secret to authenticate the client \(relying party\). For more information, see [Configure Secrets for API Authentication](configure-secrets-for-api-authentication-5c3c35e.md).

    > ### Note:  
    > The client ID and secret must be encoded using the "application/x-www-form-urlencoded" encoding algorithm.

-   X.509 Certificate
-   JWT \(client\_assertion\)



</td>
</tr>
</table>



### Request Parameters


<table>
<tr>
<th valign="top">

Parameter



</th>
<th valign="top">

Required



</th>
<th valign="top">

Data Type



</th>
<th valign="top">

Additional Information



</th>
<th valign="top">

Parameter Type



</th>
</tr>
<tr>
<td valign="top">

`grant_type`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

string



</td>
<td valign="top">

The supported value is `password`



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`username`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

string



</td>
<td valign="top">

The user identifier.



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`password`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

string



</td>
<td valign="top">

The user password, and the one-time password \(OTP\) generated by the user's registered device if the application is configured to require two-factor authentication.

> ### Note:  
> If the application requires two-factor authentication, the OTP code must be linked to the password. For example,`password=mypassword123456`.



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`refresh_expiry`



</td>
<td valign="top">

No



</td>
<td valign="top">

string



</td>
<td valign="top">

Reduces the expiration of a refresh token. It's useful if your application is called from mobile and web applications, and both have different session requirements. If you set the token lifetime to 0, you won't receive a `refresh_token` in response.



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`token_format`



</td>
<td valign="top">

No



</td>
<td valign="top">

String



</td>
<td valign="top">

The `token_format` can be set to `opaque` to retrieve an opaque access token or to `jwt` to retrieve a JWT based access token. If not set, the current defaults per grant type are used.



</td>
<td valign="top">

Request body



</td>
</tr>
</table>



### Request Example

```
grant_type=password&username=<user identifier>&password=<user password>[<otpcode>]
```



## **Response**



### Response Status and Error Codes


<table>
<tr>
<th valign="top">

Code



</th>
<th valign="top">

Result or X-Message Code



</th>
<th valign="top">

Description



</th>
</tr>
<tr>
<td valign="top">

200 OK



</td>
<td valign="top">

Successful operation.



</td>
<td valign="top">

Returns `access_token`, `refresh_token`, and `id_token`.

> ### Note:  
> The `refresh_token` is used to obtain a new `id_token` and `access_token` when the current token becomes invalid or expires. For more information, see [Call Identity Authentication Refresh Token](call-identity-authentication-refresh-token-c62c09e.md).
> 
> The `id_token` is in the form of a JWT \(JSON Web Token\) and contains information about the user. The `id_token` is valid for 60 minutes.



</td>
</tr>
<tr>
<td valign="top">

400 Bad Request



</td>
<td valign="top">

Missing or wrong parameter.



</td>
<td valign="top">

Returns an information about the error.



</td>
</tr>
<tr>
<td valign="top" rowspan="3">

401 Unauthorized



</td>
<td valign="top">

Wrong user ID or password parameters passed for the basic authentication. For more information, see [Configure Secrets for API Authentication](configure-secrets-for-api-authentication-5c3c35e.md).



</td>
<td valign="top">

The authentication of the client \(relying party\) failed.



</td>
</tr>
<tr>
<td valign="top">

PASSWORD\_CHANGE\_REQUIRED



</td>
<td valign="top">

When the user must change his or her password before logon.



</td>
</tr>
<tr>
<td valign="top">

INITIAL\_PASSWORD\_EXPIRED



</td>
<td valign="top">

When the initial password of the user has expired. After the validity of the initial password expires, the user can't log on to the application and must contact the administrator.



</td>
</tr>
</table>



### Response Payload Example

```

{
 "access_token": "387qb8bc-7t78-4eb8-8a8c-cfbe31860811",
 "refresh_token": "d12a12abcd198765dd54r456e98321"
 "id_token": 
"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxMmEzNGI1Yy02ZDc4LTll
MWYtZzM0NS02N2g4OWlqa2wxMjMiLCJzdWIiOiJQMTIzNDU2IiwibWFpbCI6ImRvbmEubW
9vcmVAZXhhbXBsZS5jb20iLCJpc3MiOiJodHRwczovL215LXRlbmFudC5hY2NvdW50cy5v
bmRlbWFuZC5jb20iLCJsYXN0X25hbWUiOiJNb29yZSIsInNhcF91aWQiOiIxMjM0NTZhYmM
3ZGU4LWZnaGktOTEyMy1qNDU2LTc4OTEya2wzNG01NiIsImV4cCI6MTU4ODAxODkyNSwiaW
F0IjoxNTg4MDEzNzYwLCJmaXJzdF9uYW1lIjoiRG9uYSIsImp0aSI6IjM4ZTQyMzMwLWRlN
2EtNDEzMC1hM2ExLWI1ODJiNTI4ZGE5OCJ9.-LSwBN2WSqnnqSkzSbg9iRmtAMR4moU5TpE
40mX0Umwg",
 "token_type": "Bearer",
 "expires_in": 300
}
```

> ### Note:  
> The format of the `issuer` depends on the configuration in the administration console for SAP Cloud Identity Services. For more information, see [Tenant OpenID Connect Configurations](tenant-openid-connect-configurations-3d6abcc.md).

 

